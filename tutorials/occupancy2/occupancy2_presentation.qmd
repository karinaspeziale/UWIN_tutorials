---
format: 
  revealjs:
    slide-number: c/t
    width: 1200
    height: 800
    theme: solarized
    transition: none
    transition-speed: fast
    incremental: false
    echo: true

---

## UWIN workshop: Occupancy modeling II

Mason Fidino and Austin Green

![](./images/github-mark.png){width=30%}

## Who we are



::: columns
::: {.column width="70%"}

::: {.nonincremental}
- Mason Fidino
  + Senior Quantitative Ecologist at the Urban Wildlife Institute, Lincoln Park Zoo
  + Analytics advisor for UWIN, helps steer database management and development
  + contact: mfidino@lpzoo.org
:::

:::
::: {.column width="30%"}

![](./images/mason_headshot.jpg)

:::
:::

## Who we are

::: columns
::: {.column width="70%"}

::: {.nonincremental}
- Austin Green
  + 
  +
  + Contact: 

:::

:::
::: {.column width="30%"}

![](./images/austin_headshot.jpg) 

:::
:::


## Autologistic occupancy models

- The most simple version of a dynamic occupancy model
  + Estimates occupancy each time step
  + No separate linear predictors for local colonization and extinction
  + Well suited when you are interested in patterns of species occupancy (you most often are)
  + Works far better than standard dynamic occupancy models when you have a smaller sample size (you most often do)
  
## The first sampling period is identical to a standard occupancy model

::: incremental
- For $i$ in $1,\dots,I$ sites
- For $t$ in $1,\dots,T$ sampling periods (e.g., UWIN sampling season)
- Let $z_{i,t}$ be the occupancy state of your species
:::

## The first sampling period is identical to a standard occupancy model


- For $i$ in $1,\dots,I$ sites
- For $t$ in $1,\dots,T$ sampling periods (e.g., UWIN sampling season)
- Let $z_{i,t}$ be the occupancy state of your species

The probability of occupancy during the first sampling period could be...
$$
\text{logit}(\psi_{i,t})  = \beta_0 + \beta_{forest}\times x_{forest, i}
$$


## After the first sampling period, autologistic models add a new parameter to 
the occupancy linear predictor

The autologistic term, $\theta$, helps control for temporal correlation in
occupancy between seasons. Therefore, occupancy at time $t$ depends on
the occupancy state in the previous timestep ($t-1$)!

$$
\text{logit}(\psi_{i,t})  = \beta_0 + \beta_{forest}\times x_{forest, i} + \theta \times z_{i,t-1}
$$

## A little bit of algebra

If this is our linear predictor...
$$
\text{logit}(\psi_{i,t})  = \beta_0 + \beta_{forest}\times x_{forest, i} + \theta \times z_{i,t-1}
$$

## A little bit of algebra

If this is our linear predictor...
$$
\text{logit}(\psi_{i,t})  = \beta_0 + \beta_{forest}\times x_{forest, i} + \theta \times z_{i,t-1}
$$

And the species is not present at $t-1$, then $z_{i,t-1} = 0$. 

$\theta \times 0 = 0$, and so the probability of occupancy when a species is not present in the previous timestep simplifies to

$$
\text{logit}(\psi_{i,t}) = \beta_0 + \beta_{forest}\times x_{forest, i}
$$




## A little bit of algebra (continued)

If this is our linear predictor...
$$
\text{logit}(\psi_{i,t})  = \beta_0 + \beta_{forest}\times x_{forest, i} + \theta \times z_{i,t-1}
$$

And the species is present at $t-1$, then $z_{i,t-1} = 1$. 

$\theta \times 1 = \theta$, and so the probability of occupancy when a species is present in the previous timestep is

$$
\text{logit}(\psi_{i,t})= \beta_0 + \beta_{forest}\times x_{forest, i} + \theta
$$


## How do you interpret the autologistic term?

::: incremental
- If $\theta$ is positive, then the model intercept $\beta_0$ increases. That 
means the occupancy of the species is higher at time $t$ if they were present at
$t-1$.
- If $\theta$ is negative, then the model intercept $\beta_0$ decreases. That means
the occupancy of the species is lower at time $t$ if they were present at $t-1$.
:::

## And what about the detection model?

::: incremental
- The detection model is nearly identical to a standard occupancy model.
- The only difference is that you can now include covariates that vary across 
sampling periods (single season models only have one sampling period).
:::

## How do you fit autologistic occupancy models?


- Code it up in your Bayesian software package of choice.


## How do you fit autologistic occupancy models?


- Code it up in your Bayesian software package of choice.
- Use `autoOcc`, an R package Mason developed to fit autologistic models, 
compare their fit via AIC, and make model predictions.

![](./images/hex.png){fig-align="center"}

## How to format your detection data

![](./images/detection_data.JPG){fig-align="center"}

## How to format your detection data

```{R}
library(autoOcc)
my_data <- read.csv("./data/example_detection_data.csv")

my_data <- format_y(
  x = my_data,
  site_column = "Site",
  time_column = "Season",
  history_columns = "Week"
)
dim(my_data)

```

## How to format your covariates

![](./images/covariate.JPG){fig-align="center"}
